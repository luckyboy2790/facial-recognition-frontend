import{V as ee,X as N,p as A,a as d,j as e,R as ae}from"./index-D0yRYkRK.js";import{A as R}from"./AdaptiveCard-C-V2GotN.js";import{B as G}from"./Button-BDkok-2I.js";import"./isNil-BZddQIJL.js";import"./context-CCEg-Yz5.js";import{T as te}from"./index-BAiP7mQm.js";import{D as se}from"./Dialog-B-jFmH1-.js";import"./index-B0EMbVo3.js";import{c as C}from"./cloneDeep-6-NADjKH.js";import"./index-2Mnet4ey.js";import"./debounce-D_S4yuNl.js";import"./index-92mjx-Fn.js";import"./index-DLKOtp8K.js";import"./Drawer-CnBtluTf.js";import"./FileItem-BgKRNRi7.js";import"./FormContainer-CcnkfPvj.js";import{I as S}from"./Input-CGGIPAMy.js";import"./index-DUpuQ3pa.js";import"./index-4hbIhcSA.js";import{t as oe,N as re}from"./toast-CHrgrvAn.js";import{S as D}from"./Select-B-WXjZfd.js";import"./index-CI41wOCL.js";import{r as ne}from"./index-CLuxvRnD.js";import{u as T}from"./index-x4T1Tg8z.js";import{d as le}from"./leaveTypeService-BeHiIq0T.js";import{D as ie}from"./DataTable-H1C01gQK.js";import{d as ce,h as pe,g as ue}from"./index-BF8ULv3O.js";import{S as de}from"./StickyFooter-CcqeJsEO.js";import{C as me}from"./ConfirmDialog-DLSh7DuB.js";import{D as ve}from"./DebouceInput-BQU4gTK3.js";import"./Card-CWfRWYfe.js";import"./classNames-CVFWYafE.js";import"./index-Chjiymov.js";import"./useMergeRef-Ch7lRZ9Z.js";import"./floating-ui.dom-CV1Qg3mg.js";import"./index-BsIi-NiL.js";import"./proxy-CceN8Kfo.js";import"./index-C6AgsrmA.js";import"./CloseButton-V3ZvNBNU.js";import"./useControllableState-DfqdUqDh.js";import"./_getPrototype-CX1IXfHZ.js";import"./isSymbol-DKaeyIQo.js";import"./toString-Db7_635E.js";import"./index-BrAlWePZ.js";import"./DatePickerRange-DFku8Lpw.js";import"./StatusIcon-BDOIg_yW.js";import"./extends-DynerIcZ.js";import"./index-BerKXuJv.js";import"./useDebounce-D4jIpCY2.js";const he={pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},ge={tableData:he,selectedLeaveGroup:[]},xe=ee(s=>({...ge,setTableData:o=>s(()=>({tableData:o})),setSelectedLeaveGroup:(o,r)=>s(l=>{const n=l.selectedLeaveGroup;return o?{selectedLeaveGroup:[...n,r]}:n.some(c=>r._id===c._id)?{selectedLeaveGroup:n.filter(c=>c._id!==r._id)}:{selectedLeaveGroup:n}}),setSelectAllLeaveGroup:o=>s(()=>({selectedLeaveGroup:o}))})),_="http://localhost:5000";async function B(s){const{token:o}=N();return A.fetchDataWithAxios({url:`${_}/api/leave_group`,method:"get",params:s,headers:o?{Authorization:`Bearer ${o}`}:{}})}async function fe(s){const{token:o}=N();return A.fetchDataWithAxios({url:`${_}/api/leave_group/create`,method:"post",data:s,headers:o?{Authorization:`Bearer ${o}`}:{}})}async function Le(s){const{token:o}=N();return A.fetchDataWithAxios({url:`${_}/api/leave_group/delete`,method:"post",data:s,headers:o?{Authorization:`Bearer ${o}`}:{}})}async function ye(s){const{token:o}=N();return A.fetchDataWithAxios({url:`${_}/api/leave_group/update`,method:"post",data:s,headers:o?{Authorization:`Bearer ${o}`}:{}})}function k(){const{tableData:s,setTableData:o,selectedLeaveGroup:r,setSelectedLeaveGroup:l,setSelectAllLeaveGroup:n}=xe(t=>t),{data:c,error:m,isLoading:v,mutate:h}=T(["/api/leaveTypes",{...s}],([t,u])=>le(),{revalidateOnFocus:!1}),{data:p,error:f,isLoading:g,mutate:L}=T(["/api/leaveGroups",{...s}],([t,u])=>B(u),{revalidateOnFocus:!1}),b=async t=>{await Le({leaveTypeIds:t}),L(),n([])},j=(p==null?void 0:p.list)||[],y=(p==null?void 0:p.total)||0;return{leaveTypesList:(c==null?void 0:c.list)||[],leaveTypesError:m,isLeaveTypesLoading:v,mutateLeaveType:h,leaveGroupsList:j,leaveGroupsListTotal:y,leaveGroupError:f,isLeaveGroupLoading:g,tableData:s,deleteLeaveGroups:b,mutateLeaveGroup:L,setTableData:o,selectedLeaveGroup:r,setSelectedLeaveGroup:l,setSelectAllLeaveGroup:n}}const be=()=>{const[s,o]=d.useState(""),[r,l]=d.useState(""),[n,c]=d.useState(""),[m,v]=d.useState([]),{mutateLeaveGroup:h,leaveTypesList:p}=k(),f=p.map(t=>({value:t._id,label:t.leave_name})),g=[{label:"Active",value:"Active"},{label:"Disabled",value:"Disabled"}],L=async()=>fe({leaveGroupName:r,description:n,leavePrivilege:m,groupStatus:s}),{data:b,isLoading:j}=T("/api/company/create",{revalidateOnFocus:!1}),y=async()=>{var t;try{if(r===""||n===""||m.length<=0||s===""){oe.push(e.jsx(re,{title:"error",type:"danger",children:"You have to fill company name."}));return}const u=await L();(t=u==null?void 0:u.leave_group)!=null&&t._id&&(h(),l(""),c(""),v([]),o("")),console.log(u)}catch(u){console.error("Error creating company:",u)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(S,{placeholder:"Leave Group Name",value:r,onChange:t=>l(t.target.value)}),e.jsx(S,{placeholder:"Description",value:n,onChange:t=>c(t.target.value)}),e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx(D,{isMulti:!0,size:"md",className:"mb-4",placeholder:"Select Leave Privileges",options:f,value:f.filter(t=>m.includes(t.value)),onChange:t=>v(t.map(u=>u.value)),getOptionLabel:t=>t.label,getOptionValue:t=>t.value}),e.jsx(D,{size:"md",className:"mb-4",placeholder:"Select Status",options:g,value:g.find(t=>t.value===s)||null,onChange:t=>o(t?t.value:""),getOptionLabel:t=>t.label,getOptionValue:t=>t.value})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(G,{variant:"solid",icon:e.jsx(ne,{}),onClick:y,loading:j,children:"Create"})})]})})},je=({onEdit:s})=>e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(te,{title:"Edit",children:e.jsx("div",{className:"text-xl cursor-pointer select-none font-semibold",role:"button",onClick:s,children:e.jsx(ce,{})})})}),Ce=()=>{const{leaveGroupsList:s,leaveGroupsListTotal:o,tableData:r,isLeaveGroupLoading:l,setTableData:n,setSelectAllLeaveGroup:c,setSelectedLeaveGroup:m,selectedLeaveGroup:v,leaveTypesList:h,mutateLeaveGroup:p}=k();console.log(s);const[f,g]=d.useState(""),[L,b]=d.useState(""),[j,y]=d.useState(""),[t,u]=d.useState([]),[F,$]=d.useState(""),P=h.map(a=>({value:a._id,label:a.leave_name})),E=[{label:"Active",value:"Active"},{label:"Disabled",value:"Disabled"}],V=async()=>B(r),[W,O]=d.useState(!1),q=async a=>{const x=(await V()).list.find(z=>z._id===a._id);x&&($(a._id),b(x.group_name||""),g(x.status||""),y(x.description||""),u(Array.isArray(x.leaveprivileges)?x.leaveprivileges:[]),O(!0))},K=async()=>await ye({_id:F,leaveGroupName:L,description:j,leavePrivilege:t,groupStatus:f}),{data:Te,isLoading:M}=T("/api/leaveGroups/create",{revalidateOnFocus:!1}),w=a=>{O(!1)},Q=async a=>{O(!1),(await K()).leave_group._id===F&&(p(),b(""),y(""),u([]),g(""))},U=d.useMemo(()=>[{header:"Group Name",accessorKey:"group_name"},{header:"Description",accessorKey:"description"},{header:"Privilege",accessorKey:"leaveTypeNames"},{header:"Status",accessorKey:"status"},{header:"",id:"action",cell:a=>e.jsx(je,{onEdit:()=>q(a.row.original)})}],[]),I=a=>{n(a),v.length>0&&c([])},X=a=>{const i=C(r);i.pageIndex=a,I(i)},Y=a=>{const i=C(r);i.pageSize=Number(a),i.pageIndex=1,I(i)},H=a=>{const i=C(r);i.sort=a,I(i)},J=(a,i)=>{m(a,i)},Z=(a,i)=>{if(a){const x=i.map(z=>z.original);c(x)}else c([])};return e.jsxs(e.Fragment,{children:[e.jsx(ie,{selectable:!0,columns:U,data:s,noData:!l&&s.length===0,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:l,pagingData:{total:o,pageIndex:r.pageIndex,pageSize:r.pageSize},checkboxChecked:a=>v.some(i=>i._id===a._id),onPaginationChange:X,onSelectChange:Y,onSort:H,onCheckBoxChange:J,onIndeterminateCheckBoxChange:Z}),e.jsxs(se,{isOpen:W,onClose:w,onRequestClose:w,children:[e.jsx("h5",{className:"mb-4",children:"Dialog Title"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(S,{placeholder:"Leave Group Name",value:L,onChange:a=>b(a.target.value)}),e.jsx(S,{placeholder:"Description",value:j,onChange:a=>y(a.target.value)}),e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx(D,{isMulti:!0,size:"md",className:"mb-4",placeholder:"Select Leave Privileges",options:P,value:P.filter(a=>t.includes(a.value)),onChange:a=>u(a.map(i=>i.value)),getOptionLabel:a=>a.label,getOptionValue:a=>a.value}),e.jsx(D,{size:"md",className:"mb-4",placeholder:"Select Status",options:E,value:E.find(a=>a.value===f)||null,onChange:a=>g(a?a.value:""),getOptionLabel:a=>a.label,getOptionValue:a=>a.value})]})]}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(G,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:w,children:"Cancel"}),e.jsx(G,{variant:"solid",onClick:Q,loading:M,children:"Okay"})]})]})]})},Ge=()=>{const{selectedLeaveGroup:s,mutateLeaveGroup:o,deleteLeaveGroups:r}=k(),[l,n]=d.useState(!1),c=()=>{n(!0)},m=()=>{n(!1)},v=async()=>{const h=s.map(p=>p._id).filter(p=>p!==void 0);if(h.length===0){console.error("No valid company IDs to delete");return}try{await r(h),n(!1),o()}catch(p){console.error("Error deleting companies:",p)}};return e.jsxs(e.Fragment,{children:[s.length>0&&e.jsx(de,{className:" flex items-center justify-between py-4 bg-white dark:bg-gray-800",stickyClass:"-mx-4 sm:-mx-8 border-t border-gray-200 dark:border-gray-700 px-8",defaultClass:"container mx-auto px-8 rounded-xl border border-gray-200 dark:border-gray-600 mt-4",children:e.jsx("div",{className:"container mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:s.length>0&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg text-primary",children:e.jsx(pe,{})}),e.jsxs("span",{className:"font-semibold flex items-center gap-1",children:[e.jsxs("span",{className:"heading-text",children:[s.length," ","LeaveTypes"]}),e.jsx("span",{children:"selected"})]})]})}),e.jsx("div",{className:"flex items-center",children:e.jsx(G,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error",onClick:c,children:"Delete"})})]})})}),e.jsx(me,{isOpen:l,type:"danger",title:"Remove customers",onClose:m,onRequestClose:m,onCancel:m,onConfirm:v,children:e.jsxs("p",{children:[" ","Are you sure you want to remove these companies? This action can't be undo."," "]})})]})},Se=s=>{const{onInputChange:o,ref:r}=s;return e.jsx(ve,{ref:r,placeholder:"Quick search...",suffix:e.jsx(ue,{className:"text-lg"}),onChange:l=>o(l.target.value)})},De=()=>{const{tableData:s,setTableData:o}=k(),r=l=>{const n=C(s);n.query=l,n.pageIndex=1,typeof l=="string"&&l.length>1&&o(n),typeof l=="string"&&l.length===0&&o(n)};return e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:e.jsx(Se,{onInputChange:r})})},Ca=()=>e.jsxs(e.Fragment,{children:[e.jsx(ae,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:e.jsx("h3",{children:"Add Leave Groups"})}),e.jsx(R,{children:e.jsx(be,{})}),e.jsxs(R,{children:[e.jsx(De,{}),e.jsx(Ce,{})]})]})}),e.jsx(Ge,{})]});export{Ca as default};
