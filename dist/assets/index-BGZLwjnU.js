import{V as v,a as S,j as e,W as T,R as N}from"./index-D0yRYkRK.js";import{A as w}from"./AdaptiveCard-C-V2GotN.js";import{T as L}from"./Tag-BiKNl5cb.js";import{b as k}from"./employeeService-8m6wHAGi.js";import{u as F}from"./index-x4T1Tg8z.js";import{c as g}from"./cloneDeep-6-NADjKH.js";import{R as I}from"./ReportDataTable-C0sCAkFY.js";import{B as h}from"./Button-BDkok-2I.js";import{G as R}from"./index-BitVXSiq.js";import{C as A}from"./index-DasjbrLe.js";import{v as P,g as z,t as O}from"./index-BF8ULv3O.js";import{D as K}from"./DebouceInput-BQU4gTK3.js";import{D as E}from"./Dialog-B-jFmH1-.js";import{C as j}from"./index-2Mnet4ey.js";import{I as G}from"./Input-CGGIPAMy.js";import{u as q,F as M,C as b}from"./index.esm-0Wd5ZTaL.js";import"./FormContainer-CcnkfPvj.js";import{F as D}from"./FormItem-BzCUTsvV.js";import{z as f,t as V}from"./index-DMQ2Y9Ia.js";import"./Card-CWfRWYfe.js";import"./classNames-CVFWYafE.js";import"./useControllableState-DfqdUqDh.js";import"./_getPrototype-CX1IXfHZ.js";import"./index-B0EMbVo3.js";import"./index-CLuxvRnD.js";import"./Select-B-WXjZfd.js";import"./extends-DynerIcZ.js";import"./floating-ui.dom-CV1Qg3mg.js";import"./index-BerKXuJv.js";import"./index-Chjiymov.js";import"./useDebounce-D4jIpCY2.js";import"./debounce-D_S4yuNl.js";import"./isSymbol-DKaeyIQo.js";import"./index-C6AgsrmA.js";import"./CloseButton-V3ZvNBNU.js";import"./proxy-CceN8Kfo.js";import"./toString-Db7_635E.js";import"./isNil-BZddQIJL.js";import"./index-BsIi-NiL.js";const B={pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},W={purchasedProducts:"",purchaseChannel:["Retail Stores","Online Retailers","Resellers","Mobile Apps","Direct Sales"]},Q={tableData:B,filterData:W,selectedCustomer:[]},U=v(s=>({...Q,setFilterData:t=>s(()=>({filterData:t})),setTableData:t=>s(()=>({tableData:t})),setSelectedCustomer:(t,o)=>s(l=>{const n=l.selectedCustomer;return t?{selectedCustomer:[...n,o]}:n.some(i=>o.id===i.id)?{selectedCustomer:n.filter(i=>i.id!==o.id)}:{selectedCustomer:n}}),setSelectAllCustomer:t=>s(()=>({selectedCustomer:t}))}));function C(){const{tableData:s,filterData:t,setTableData:o,selectedCustomer:l,setSelectedCustomer:n,setSelectAllCustomer:i,setFilterData:p}=U(r=>r),{data:c,error:d,isLoading:x,mutate:m}=F(["/api/customers",{...s,...t}],([r,y])=>k(y),{revalidateOnFocus:!1}),u=(c==null?void 0:c.list)||[],a=(c==null?void 0:c.total)||0;return{customerList:u,customerListTotal:a,error:d,isLoading:x,tableData:s,filterData:t,mutate:m,setTableData:o,selectedCustomer:l,setSelectedCustomer:n,setSelectAllCustomer:i,setFilterData:p}}const _={active:"bg-emerald-200 dark:bg-emerald-200 text-gray-900 dark:text-gray-900",archive:"bg-red-200 dark:bg-red-200 text-gray-900 dark:text-gray-900"},$=({row:s})=>e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"hover:text-primary ml-2 rtl:mr-2 font-semibold text-gray-900 dark:text-gray-100",children:s.name})}),H=()=>{const{customerList:s,customerListTotal:t,tableData:o,isLoading:l,setTableData:n,setSelectAllCustomer:i,selectedCustomer:p}=C(),c=S.useMemo(()=>[{header:"Name",accessorKey:"name",cell:a=>{const r=a.row.original;return e.jsx($,{row:r})}},{header:"Email",accessorKey:"email"},{header:"location",accessorKey:"personalInfo.location"},{header:"Status",accessorKey:"status",cell:a=>{const r=a.row.original;return e.jsx("div",{className:"flex items-center",children:e.jsx(L,{className:_[r.status],children:e.jsx("span",{className:"capitalize",children:r.status})})})}},{header:"Spent",accessorKey:"totalSpending",cell:a=>e.jsxs("span",{children:["$",a.row.original.totalSpending]})}],[]),d=a=>{n(a),p.length>0&&i([])},x=a=>{const r=g(o);r.pageIndex=a,d(r)},m=a=>{const r=g(o);r.pageSize=Number(a),r.pageIndex=1,d(r)},u=a=>{const r=g(o);r.sort=a,d(r)};return e.jsx(I,{selectable:!0,columns:c,data:s,noData:!l&&s.length===0,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:l,pagingData:{total:t,pageIndex:o.pageIndex,pageSize:o.pageSize},checkboxChecked:a=>p.some(r=>r.id===a.id),onPaginationChange:x,onSelectChange:m,onSort:u})},J=()=>{const s=T(),{customerList:t}=C();return e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx(h,{variant:"default",icon:e.jsx(R,{className:"text-xl"}),onClick:()=>s("/reports"),children:"Return"}),e.jsx(A,{className:"w-full",filename:"customerList.csv",data:t,children:e.jsx(h,{icon:e.jsx(P,{className:"text-xl"}),className:"w-full",children:"Download"})})]})},X=s=>{const{onInputChange:t,ref:o}=s;return e.jsx(K,{ref:o,placeholder:"Quick search...",suffix:e.jsx(z,{className:"text-lg"}),onChange:l=>t(l.target.value)})},Y=["Retail Stores","Online Retailers","Resellers","Mobile Apps","Direct Sales"],Z=f.object({purchasedProducts:f.string(),purchaseChannel:f.array(f.string())}),ee=()=>{const[s,t]=S.useState(!1),{filterData:o,setFilterData:l}=C(),n=()=>{t(!0)},i=()=>{t(!1)},{handleSubmit:p,reset:c,control:d}=q({defaultValues:o,resolver:V(Z)}),x=m=>{l(m),t(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(h,{icon:e.jsx(O,{}),onClick:()=>n(),children:"Filter"}),e.jsxs(E,{isOpen:s,onClose:i,onRequestClose:i,children:[e.jsx("h4",{className:"mb-4",children:"Filter"}),e.jsxs(M,{onSubmit:p(x),children:[e.jsx(D,{label:"Products",children:e.jsx(b,{name:"purchasedProducts",control:d,render:({field:m})=>e.jsx(G,{type:"text",autoComplete:"off",placeholder:"Search by purchased product",...m})})}),e.jsx(D,{label:"Purchase Channel",children:e.jsx(b,{name:"purchaseChannel",control:d,render:({field:m})=>e.jsx(j.Group,{vertical:!0,className:"flex mt-4",...m,children:Y.map((u,a)=>e.jsx(j,{name:m.name,value:u,className:"justify-between flex-row-reverse heading-text",children:u},u+a))})})}),e.jsxs("div",{className:"flex justify-end items-center gap-2 mt-4",children:[e.jsx(h,{type:"button",onClick:()=>c(),children:"Reset"}),e.jsx(h,{type:"submit",variant:"solid",children:"Apply"})]})]})]})]})},te=()=>{const{tableData:s,setTableData:t}=C(),o=l=>{const n=g(s);n.query=l,n.pageIndex=1,typeof l=="string"&&l.length>1&&t(n),typeof l=="string"&&l.length===0&&t(n)};return e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx(X,{onInputChange:o}),e.jsx(ee,{})]})},Me=()=>e.jsx(e.Fragment,{children:e.jsx(N,{children:e.jsx(w,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx("h3",{children:"User Accounts Report"}),e.jsx(J,{})]}),e.jsx(te,{}),e.jsx(H,{})]})})})});export{Me as default};
