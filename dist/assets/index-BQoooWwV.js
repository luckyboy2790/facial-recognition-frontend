import{V as w,W as D,a as C,j as e,R as N}from"./index-D0yRYkRK.js";import{A as k}from"./AdaptiveCard-C-V2GotN.js";import{T as _}from"./index-BAiP7mQm.js";import{D as I}from"./DataTable-H1C01gQK.js";import{u as L}from"./index-x4T1Tg8z.js";import{a as R,b as F}from"./AttendanceService-BTxDC8aW.js";import{c as u}from"./cloneDeep-6-NADjKH.js";import{d as O,f as E,h as P}from"./index-BF8ULv3O.js";import{B as y}from"./Button-BDkok-2I.js";import{D as z}from"./DatePickerRange-DFku8Lpw.js";import{S as K}from"./StickyFooter-CcqeJsEO.js";import{C as B}from"./ConfirmDialog-DLSh7DuB.js";import"./Card-CWfRWYfe.js";import"./useMergeRef-Ch7lRZ9Z.js";import"./floating-ui.dom-CV1Qg3mg.js";import"./index-BsIi-NiL.js";import"./proxy-CceN8Kfo.js";import"./index-B0EMbVo3.js";import"./index-CLuxvRnD.js";import"./classNames-CVFWYafE.js";import"./Select-B-WXjZfd.js";import"./extends-DynerIcZ.js";import"./index-2Mnet4ey.js";import"./isSymbol-DKaeyIQo.js";import"./toString-Db7_635E.js";import"./index-BerKXuJv.js";import"./useControllableState-DfqdUqDh.js";import"./_getPrototype-CX1IXfHZ.js";import"./Input-CGGIPAMy.js";import"./isNil-BZddQIJL.js";import"./CloseButton-V3ZvNBNU.js";import"./useDebounce-D4jIpCY2.js";import"./debounce-D_S4yuNl.js";import"./Dialog-B-jFmH1-.js";import"./index-C6AgsrmA.js";import"./index-Chjiymov.js";const q={pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},M={purchasedProducts:"",purchaseChannel:["Retail Stores","Online Retailers","Resellers","Mobile Apps","Direct Sales"]},W={tableData:q,filterData:M,selectedAttendance:[]},H=w(a=>({...W,setFilterData:n=>a(()=>({filterData:n})),setTableData:n=>a(()=>({tableData:n})),setSelectedAttendance:(n,i)=>a(s=>{const t=s.selectedAttendance;return n?{selectedAttendance:[...t,i]}:t.some(l=>i._id===l._id)?{selectedAttendance:t.filter(l=>l._id!==i._id)}:{selectedAttendance:t}}),setSelectAllAttendance:n=>a(()=>({selectedAttendance:n}))}));function A(){const{tableData:a,filterData:n,setTableData:i,selectedAttendance:s,setSelectedAttendance:t,setSelectAllAttendance:l,setFilterData:d}=H(h=>h),{data:c,error:p,isLoading:m,mutate:g}=L(["/api/attendance",{...a}],([h,j])=>R(j),{revalidateOnFocus:!1}),x=async h=>{await F({attendanceIds:h}),g(),l([])},f=(c==null?void 0:c.list)||[],b=(c==null?void 0:c.total)||0;return{attendanceList:f,attendanceListTotal:b,error:p,isLoading:m,tableData:a,filterData:n,deleteAttendances:x,mutate:g,setTableData:i,selectedAttendance:s,setSelectedAttendance:t,setSelectAllAttendance:l,setFilterData:d}}const J=({onEdit:a})=>e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(_,{title:"Edit",children:e.jsx("div",{className:"text-xl cursor-pointer select-none font-semibold",role:"button",onClick:a,children:e.jsx(O,{})})})}),U=()=>{const a=D(),{attendanceList:n,attendanceListTotal:i,tableData:s,isLoading:t,setTableData:l,setSelectAllAttendance:d,setSelectedAttendance:c,selectedAttendance:p}=A(),m=r=>{a(`/attendance-edit/${r._id}`)},g=C.useMemo(()=>[{header:"Date",accessorKey:"date"},{header:"Employee",accessorKey:"employeeData.full_name"},{header:"Time In",accessorKey:"time_in"},{header:"Time Out",accessorKey:"time_out"},{header:"Total Hours",accessorKey:"total_hours"},{header:"Status (In/Out)",id:"status",cell:r=>e.jsxs("div",{children:[r.row.original.status_timein," /"," ",r.row.original.status_timeout]})},{header:"",id:"action",cell:r=>e.jsx(J,{onEdit:()=>m(r.row.original)})}],[]),x=r=>{l(r),p.length>0&&d([])},f=r=>{const o=u(s);o.pageIndex=r,x(o)},b=r=>{const o=u(s);o.pageSize=Number(r),o.pageIndex=1,x(o)},h=r=>{const o=u(s);o.sort=r,x(o)},j=(r,o)=>{c(r,o)},S=(r,o)=>{if(r){const T=o.map(v=>v.original);d(T)}else d([])};return e.jsx(I,{selectable:!0,columns:g,data:n,noData:!t&&n.length===0,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:t,pagingData:{total:i,pageIndex:s.pageIndex,pageSize:s.pageSize},checkboxChecked:r=>p.some(o=>o._id===r._id),onPaginationChange:f,onSelectChange:b,onSort:h,onCheckBoxChange:j,onIndeterminateCheckBoxChange:S})},V=()=>{const a=D();return e.jsx("div",{className:"flex flex-col md:flex-row gap-3",children:e.jsx(y,{variant:"solid",icon:e.jsx(E,{className:"text-xl"}),onClick:()=>a("/attendance-create"),children:"Add new"})})},$=a=>{const{onInputChange:n,ref:i}=a,s=t=>{t[0]&&t[1]?n(JSON.stringify([t[0],t[1]])):n("")};return e.jsx(e.Fragment,{children:e.jsx(z,{ref:i,placeholder:"Select date",onChange:s})})},G=()=>{const{tableData:a,setTableData:n}=A(),i=s=>{const t=u(a);t.query=s,t.pageIndex=1,typeof s=="string"&&s.length>1&&n(t),typeof s=="string"&&s.length===0&&n(t),console.log(s)};return e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:e.jsx($,{onInputChange:i})})},Q=()=>{const{selectedAttendance:a,mutate:n,deleteAttendances:i}=A(),[s,t]=C.useState(!1),l=()=>{t(!0)},d=()=>{t(!1)},c=async()=>{const p=a.map(m=>m._id).filter(m=>m!==void 0);if(p.length===0){console.error("No valid employee IDs to delete");return}try{await i(p),t(!1),n()}catch(m){console.error("Error deleting companies:",m)}};return e.jsxs(e.Fragment,{children:[a.length>0&&e.jsx(K,{className:" flex items-center justify-between py-4 bg-white dark:bg-gray-800",stickyClass:"-mx-4 sm:-mx-8 border-t border-gray-200 dark:border-gray-700 px-8",defaultClass:"container mx-auto px-8 rounded-xl border border-gray-200 dark:border-gray-600 mt-4",children:e.jsx("div",{className:"container mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:a.length>0&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg text-primary",children:e.jsx(P,{})}),e.jsxs("span",{className:"font-semibold flex items-center gap-1",children:[e.jsxs("span",{className:"heading-text",children:[a.length," ","Attendances"]}),e.jsx("span",{children:"selected"})]})]})}),e.jsx("div",{className:"flex items-center",children:e.jsx(y,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error",onClick:l,children:"Delete"})})]})})}),e.jsx(B,{isOpen:s,type:"danger",title:"Remove attendances",onClose:d,onRequestClose:d,onCancel:d,onConfirm:c,children:e.jsxs("p",{children:[" ","Are you sure you want to remove these attendances? This action can't be undo."," "]})})]})},Re=()=>e.jsxs(e.Fragment,{children:[e.jsx(N,{children:e.jsx(k,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx("h3",{children:"Attendances"}),e.jsx(V,{})]}),e.jsx(G,{}),e.jsx(U,{})]})})}),e.jsx(Q,{})]});export{Re as default};
