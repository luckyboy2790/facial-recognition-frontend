import{a as f,j as e,i as C,R as y}from"./index-D0yRYkRK.js";import{C as s,u as w,F as b}from"./index.esm-0Wd5ZTaL.js";import"./FormContainer-CcnkfPvj.js";import"./Button-BDkok-2I.js";import{B as D}from"./BottomStickyBar-B9Gkuokk.js";import{C as E}from"./Card-CWfRWYfe.js";import{F as m}from"./FormItem-BzCUTsvV.js";import{a as _,T as d}from"./FileItem-BgKRNRi7.js";import{g as B}from"./employeeService-8m6wHAGi.js";import"./index-BAiP7mQm.js";import"./index-2Mnet4ey.js";import"./Dialog-B-jFmH1-.js";import"./Drawer-CnBtluTf.js";import"./index-92mjx-Fn.js";import{I as N}from"./Input-CGGIPAMy.js";import"./index-DUpuQ3pa.js";import"./index-4hbIhcSA.js";import"./cloneDeep-6-NADjKH.js";import{S as T}from"./Select-B-WXjZfd.js";import"./index-B0EMbVo3.js";import"./index-CI41wOCL.js";import"./toast-CHrgrvAn.js";import{f as S}from"./format-BzRktsyD.js";const F=({control:r,errors:o,defaultValues:n,newAttendance:u})=>{var c,p,x,h;const[l,g]=f.useState([]);f.useEffect(()=>{(async()=>{try{const j=(await B()).employeeData.map(v=>({value:v._id,label:v.full_name}));g(j)}catch(a){console.error("Error fetching data:",a)}})()},[]);const i=()=>{const t=new Date,a=t.getFullYear(),j=String(t.getMonth()+1).padStart(2,"0");return`${a}-${j}-01`};return e.jsxs(E,{children:[e.jsx("h4",{className:"mb-6",children:"Attendance Edit"}),e.jsx(m,{label:"Employee",invalid:!!o.employee,errorMessage:(c=o.employee)==null?void 0:c.message,children:e.jsx(s,{name:"employee",control:r,render:({field:t})=>e.jsx(T,{className:"mb-4",placeholder:"Please Select",options:l,value:l.find(a=>a.value===t.value),onChange:a=>t.onChange(a==null?void 0:a.value)})})}),e.jsx(m,{label:"Date",invalid:!!o.date,errorMessage:(p=o.date)==null?void 0:p.message,children:e.jsx(s,{name:"date",control:r,render:({field:t})=>e.jsx(_,{placeholder:"Date",value:t.value?new Date(t.value):null,onChange:a=>{t.onChange(a?a.toISOString().split("T")[0]:"")}})})}),e.jsx(m,{label:"Start time",invalid:!!o.time_in,errorMessage:(x=o.time_in)==null?void 0:x.message,children:e.jsx(s,{name:"time_in",control:r,defaultValue:(n==null?void 0:n.time_in)||"",render:({field:t})=>e.jsx(d,{value:t.value?new Date(`${i()}T${t.value}`):null,onChange:a=>{a&&t.onChange(S(a,"HH:mm:ss.SSS")+"Z")}})})}),e.jsx(m,{label:"Off Time",invalid:!!o.time_out,errorMessage:(h=o.time_out)==null?void 0:h.message,children:e.jsx(s,{name:"time_out",control:r,defaultValue:(n==null?void 0:n.time_out)||"",render:({field:t})=>e.jsx(d,{value:t.value?new Date(`${i()}T${t.value}`):null,onChange:a=>{a&&t.onChange(S(a,"HH:mm:ss.SSS")+"Z")}})})}),!u&&e.jsx(m,{label:"Reason",children:e.jsx(s,{name:"reason",control:r,defaultValue:(n==null?void 0:n.reason)||"",render:({field:t})=>e.jsx(N,{type:"text",textArea:!0,autoComplete:"off",placeholder:"Reason",value:t.value,onChange:t.onChange,onBlur:t.onBlur})})})]})},te=r=>{const{onFormSubmit:o,defaultValues:n={},children:u,newAttendance:l}=r,{handleSubmit:g,reset:i,formState:{errors:c},control:p}=w({defaultValues:{...n}});f.useEffect(()=>{C(n)||i(n)},[JSON.stringify(n)]);const x=h=>{o==null||o(h)};return e.jsxs(b,{className:"flex w-full h-full",containerClassName:"flex flex-col w-full justify-between",onSubmit:g(x),children:[e.jsx(y,{children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsx("div",{className:"gap-4 flex flex-col flex-auto",children:e.jsx(F,{control:p,errors:c,newAttendance:l})})})}),e.jsx(D,{children:u})]})};export{te as A};
