import{j as e,V as w,a as b,R as T}from"./index-D0yRYkRK.js";import{A as C}from"./AdaptiveCard-C-V2GotN.js";import{B as u}from"./Button-BDkok-2I.js";import"./isNil-BZddQIJL.js";import"./context-CCEg-Yz5.js";import"./index-BAiP7mQm.js";import"./Dialog-B-jFmH1-.js";import"./index-B0EMbVo3.js";import{c as h}from"./cloneDeep-6-NADjKH.js";import"./index-2Mnet4ey.js";import"./debounce-D_S4yuNl.js";import"./index-92mjx-Fn.js";import"./index-DLKOtp8K.js";import"./Drawer-CnBtluTf.js";import{v as k,C as L,h as I,g as A}from"./index-BF8ULv3O.js";import{C as _}from"./index-DasjbrLe.js";import"./FileItem-BgKRNRi7.js";import"./FormContainer-CcnkfPvj.js";import{I as R}from"./Input-CGGIPAMy.js";import"./index-DUpuQ3pa.js";import"./index-4hbIhcSA.js";import{t as F,N as z}from"./toast-CHrgrvAn.js";import"./index-CI41wOCL.js";import{r as O}from"./index-CLuxvRnD.js";import{a as q,b as B,c as E}from"./DepartmentService-DVdaCjHZ.js";import{u as y}from"./index-x4T1Tg8z.js";import{D as P}from"./DataTable-H1C01gQK.js";import{S as V}from"./StickyFooter-CcqeJsEO.js";import{C as K}from"./ConfirmDialog-DLSh7DuB.js";import{D as M}from"./DebouceInput-BQU4gTK3.js";import"./Card-CWfRWYfe.js";import"./classNames-CVFWYafE.js";import"./index-Chjiymov.js";import"./useMergeRef-Ch7lRZ9Z.js";import"./floating-ui.dom-CV1Qg3mg.js";import"./index-BsIi-NiL.js";import"./proxy-CceN8Kfo.js";import"./index-C6AgsrmA.js";import"./CloseButton-V3ZvNBNU.js";import"./useControllableState-DfqdUqDh.js";import"./_getPrototype-CX1IXfHZ.js";import"./isSymbol-DKaeyIQo.js";import"./toString-Db7_635E.js";import"./index-BrAlWePZ.js";import"./DatePickerRange-DFku8Lpw.js";import"./StatusIcon-BDOIg_yW.js";import"./Select-B-WXjZfd.js";import"./extends-DynerIcZ.js";import"./index-BerKXuJv.js";import"./useDebounce-D4jIpCY2.js";const Q=()=>{const t=[];return e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx(_,{className:"w-full",filename:"customerList.csv",data:t,children:e.jsx(u,{icon:e.jsx(k,{className:"text-xl"}),className:"w-full",children:"Download"})}),e.jsx(u,{variant:"solid",icon:e.jsx(L,{className:"text-xl"}),children:"Import"})]})},U={pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},W={tableData:U,selectedDepartment:[]},Y=w(t=>({...W,setTableData:a=>t(()=>({tableData:a})),setSelectedDepartment:(a,r)=>t(s=>{const n=s.selectedDepartment;return a?{selectedDepartment:[...n,r]}:n.some(o=>r._id===o._id)?{selectedDepartment:n.filter(o=>o._id!==r._id)}:{selectedDepartment:n}}),setSelectAllDepartment:a=>t(()=>({selectedDepartment:a}))}));function g(){const{tableData:t,setTableData:a,selectedDepartment:r,setSelectedDepartment:s,setSelectAllDepartment:n}=Y(x=>x),{data:o,error:d,isLoading:c,mutate:l}=y(["/api/departments",{...t}],([x,j])=>q(j),{revalidateOnFocus:!1}),p=async x=>{await B({companies:x}),l(),n([])},f=(o==null?void 0:o.list)||[],D=(o==null?void 0:o.total)||0;return{departmentList:f,departmentListTotal:D,error:d,isLoading:c,tableData:t,mutate:l,setTableData:a,deleteDepartments:p,selectedDepartment:r,setSelectedDepartment:s,setSelectAllDepartment:n}}const G=()=>{const[t,a]=b.useState(""),{mutate:r}=g(),s=async()=>E({departmentName:t}),{data:n,isLoading:o}=y("/api/department/create",{revalidateOnFocus:!1}),d=async()=>{var c;try{if(t===""){F.push(e.jsx(z,{title:"error",type:"danger",children:"You have to fill department name."}));return}const l=await s();(c=l==null?void 0:l.department)!=null&&c._id&&(r(),a("")),console.log(l)}catch(l){console.error("Error creating department:",l)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex justify-between items-center gap-4",children:[e.jsx(R,{placeholder:"Department Name",required:!0,value:t,onChange:c=>a(c.target.value)}),e.jsx(u,{variant:"solid",icon:e.jsx(O,{}),onClick:d,disabled:o,children:"Create"})]})})},H=()=>{const{departmentList:t,departmentListTotal:a,tableData:r,isLoading:s,setTableData:n,setSelectAllDepartment:o,setSelectedDepartment:d,selectedDepartment:c}=g(),l=b.useMemo(()=>[{header:"Department",accessorKey:"department_name"}],[]),p=m=>{n(m),c.length>0&&o([])},f=m=>{const i=h(r);i.pageIndex=m,p(i)},D=m=>{const i=h(r);i.pageSize=Number(m),i.pageIndex=1,p(i)},x=m=>{const i=h(r);i.sort=m,p(i)},j=(m,i)=>{d(m,i)},S=(m,i)=>{if(m){const N=i.map(v=>v.original);o(N)}else o([])};return e.jsx(P,{selectable:!0,columns:l,data:t,noData:!s&&t.length===0,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:s,pagingData:{total:a,pageIndex:r.pageIndex,pageSize:r.pageSize},checkboxChecked:m=>c.some(i=>i._id===m._id),onPaginationChange:f,onSelectChange:D,onSort:x,onCheckBoxChange:j,onIndeterminateCheckBoxChange:S})},J=()=>{const{selectedDepartment:t,mutate:a,deleteDepartments:r}=g(),[s,n]=b.useState(!1),o=()=>{n(!0)},d=()=>{n(!1)},c=async()=>{const l=t.map(p=>p._id).filter(p=>p!==void 0);if(l.length===0){console.error("No valid department IDs to delete");return}try{await r(l),n(!1),a()}catch(p){console.error("Error deleting department:",p)}};return e.jsxs(e.Fragment,{children:[t.length>0&&e.jsx(V,{className:" flex items-center justify-between py-4 bg-white dark:bg-gray-800",stickyClass:"-mx-4 sm:-mx-8 border-t border-gray-200 dark:border-gray-700 px-8",defaultClass:"container mx-auto px-8 rounded-xl border border-gray-200 dark:border-gray-600 mt-4",children:e.jsx("div",{className:"container mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:t.length>0&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg text-primary",children:e.jsx(I,{})}),e.jsxs("span",{className:"font-semibold flex items-center gap-1",children:[e.jsxs("span",{className:"heading-text",children:[t.length," ","Departments"]}),e.jsx("span",{children:"selected"})]})]})}),e.jsx("div",{className:"flex items-center",children:e.jsx(u,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error",onClick:o,children:"Delete"})})]})})}),e.jsx(K,{isOpen:s,type:"danger",title:"Remove departments",onClose:d,onRequestClose:d,onCancel:d,onConfirm:c,children:e.jsxs("p",{children:[" ","Are you sure you want to remove these departments? This action can't be undo."," "]})})]})},X=t=>{const{onInputChange:a,ref:r}=t;return e.jsx(M,{ref:r,placeholder:"Quick search...",suffix:e.jsx(A,{className:"text-lg"}),onChange:s=>a(s.target.value)})},Z=()=>{const{tableData:t,setTableData:a}=g(),r=s=>{const n=h(t);n.query=s,n.pageIndex=1,typeof s=="string"&&s.length>1&&a(n),typeof s=="string"&&s.length===0&&a(n)};return e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:e.jsx(X,{onInputChange:r})})},He=()=>e.jsxs(e.Fragment,{children:[e.jsx(T,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx("h3",{children:"Add Department"}),e.jsx(Q,{})]}),e.jsx(C,{children:e.jsx(G,{})}),e.jsxs(C,{children:[e.jsx(Z,{}),e.jsx(H,{})]})]})}),e.jsx(J,{})]});export{He as default};
