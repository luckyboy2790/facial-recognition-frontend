import{V as L,W as j,a as y,j as e,R as I}from"./index-D0yRYkRK.js";import{A as _}from"./AdaptiveCard-C-V2GotN.js";import{T as R}from"./Tag-BiKNl5cb.js";import{T as b}from"./index-BAiP7mQm.js";import{D as P}from"./DataTable-H1C01gQK.js";import{u as E}from"./index-x4T1Tg8z.js";import{a as F,b as K,c as z}from"./ScheduleService-Cik7LwTI.js";import{c as p}from"./cloneDeep-6-NADjKH.js";import{d as O,f as B,g as q,h as W}from"./index-BF8ULv3O.js";import{a as H}from"./index-Car4HhLt.js";import{B as C}from"./Button-BDkok-2I.js";import{D as M}from"./DebouceInput-BQU4gTK3.js";import{S as Q}from"./StickyFooter-CcqeJsEO.js";import{C as U}from"./ConfirmDialog-DLSh7DuB.js";import"./Card-CWfRWYfe.js";import"./classNames-CVFWYafE.js";import"./useMergeRef-Ch7lRZ9Z.js";import"./floating-ui.dom-CV1Qg3mg.js";import"./index-BsIi-NiL.js";import"./proxy-CceN8Kfo.js";import"./index-B0EMbVo3.js";import"./index-CLuxvRnD.js";import"./Select-B-WXjZfd.js";import"./extends-DynerIcZ.js";import"./index-2Mnet4ey.js";import"./isSymbol-DKaeyIQo.js";import"./toString-Db7_635E.js";import"./index-BerKXuJv.js";import"./useControllableState-DfqdUqDh.js";import"./_getPrototype-CX1IXfHZ.js";import"./Input-CGGIPAMy.js";import"./isNil-BZddQIJL.js";import"./useDebounce-D4jIpCY2.js";import"./debounce-D_S4yuNl.js";import"./Dialog-B-jFmH1-.js";import"./index-C6AgsrmA.js";import"./index-Chjiymov.js";import"./CloseButton-V3ZvNBNU.js";const V={pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},$={tableData:V,selectedSchedule:[]},G=L(s=>({...$,setTableData:r=>s(()=>({tableData:r})),setSelectedSchedule:(r,n)=>s(o=>{const l=o.selectedSchedule;return r?{selectedSchedule:[...l,n]}:l.some(c=>n._id===c._id)?{selectedSchedule:l.filter(c=>c._id!==n._id)}:{selectedSchedule:l}}),setSelectAllSchedule:r=>s(()=>({selectedSchedule:r}))}));function S(){const{tableData:s,setTableData:r,selectedSchedule:n,setSelectedSchedule:o,setSelectAllSchedule:l}=G(m=>m),{data:c,error:i,isLoading:u,mutate:h}=E(["/api/schedules",{...s}],([m,x])=>F(x),{revalidateOnFocus:!1}),d=async m=>{await K({scheduleIds:m}),h(),l([])},g=(c==null?void 0:c.list)||[],f=(c==null?void 0:c.total)||0;return{scheduleList:g,scheduleListTotal:f,error:i,isLoading:u,tableData:s,mutate:h,setTableData:r,deleteSchedules:d,selectedSchedule:n,setSelectedSchedule:o,setSelectAllSchedule:l}}const J={Previous:"bg-emerald-200 dark:bg-emerald-200 text-gray-900 dark:text-gray-900",Present:"bg-red-200 dark:bg-red-200 text-gray-900 dark:text-gray-900"},X=({onEdit:s,onArchive:r,row:n})=>e.jsx("div",{className:"flex items-center gap-3",children:n.status==="Present"&&e.jsxs(e.Fragment,{children:[e.jsx(b,{title:"Edit",children:e.jsx("div",{className:"text-xl cursor-pointer select-none font-semibold",role:"button",onClick:s,children:e.jsx(O,{})})}),e.jsx(b,{title:"Archive",children:e.jsx("div",{className:"text-xl cursor-pointer select-none font-semibold",role:"button",onClick:r,children:e.jsx(H,{})})})]})}),Y=()=>{const s=j(),{scheduleList:r,scheduleListTotal:n,tableData:o,isLoading:l,setTableData:c,setSelectAllSchedule:i,setSelectedSchedule:u,selectedSchedule:h,mutate:d}=S();console.log(r);const g=t=>{s(`/schedule-edit/${t._id}`)},f=async t=>{try{console.log(t),(await z({scheduleId:t})).schedule&&d()}catch(a){console.error("Error archiving schedule:",a)}},m=y.useMemo(()=>[{header:"Schedule",accessorKey:"employee_name"},{header:"Time (Start-Off)",accessorKey:"formattedTime"},{header:"Hours",accessorKey:"total_hours"},{header:"Rest Days",accessorKey:"rest_days"},{header:"From (Date)",accessorKey:"formattedFromDate"},{header:"To (Date)",accessorKey:"formattedToDate"},{header:"Status",accessorKey:"status",cell:t=>{const a=t.row.original;return e.jsx("div",{className:"flex items-center",children:e.jsx(R,{className:J[a.status],children:e.jsx("span",{className:"capitalize",children:a.status})})})}},{header:"",id:"action",cell:t=>e.jsx(X,{onEdit:()=>g(t.row.original),onArchive:()=>f(t.row.original._id),row:t.row.original})}],[]),x=t=>{c(t),h.length>0&&i([])},D=t=>{const a=p(o);a.pageIndex=t,x(a)},v=t=>{const a=p(o);a.pageSize=Number(t),a.pageIndex=1,x(a)},T=t=>{const a=p(o);a.sort=t,x(a)},w=(t,a)=>{u(t,a)},N=(t,a)=>{if(t){const k=a.map(A=>A.original);i(k)}else i([])};return e.jsx(P,{selectable:!0,columns:m,data:r,noData:!l&&r.length===0,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:l,pagingData:{total:n,pageIndex:o.pageIndex,pageSize:o.pageSize},checkboxChecked:t=>h.some(a=>a._id===t._id),onPaginationChange:D,onSelectChange:v,onSort:T,onCheckBoxChange:w,onIndeterminateCheckBoxChange:N})},Z=()=>{const s=j();return e.jsx("div",{className:"flex flex-col md:flex-row gap-3",children:e.jsx(C,{variant:"solid",icon:e.jsx(B,{className:"text-xl"}),onClick:()=>s("/schedule-create"),children:"Add new"})})},ee=s=>{const{onInputChange:r,ref:n}=s;return e.jsx(M,{ref:n,placeholder:"Quick search...",suffix:e.jsx(q,{className:"text-lg"}),onChange:o=>r(o.target.value)})},te=()=>{const{tableData:s,setTableData:r}=S(),n=o=>{const l=p(s);l.query=o,l.pageIndex=1,typeof o=="string"&&o.length>1&&r(l),typeof o=="string"&&o.length===0&&r(l)};return e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:e.jsx(ee,{onInputChange:n})})},se=()=>{const{selectedSchedule:s,mutate:r,deleteSchedules:n}=S(),[o,l]=y.useState(!1),c=()=>{l(!0)},i=()=>{l(!1)},u=async()=>{const h=s.map(d=>d._id).filter(d=>d!==void 0);if(h.length===0){console.error("No valid employee IDs to delete");return}try{await n(h),l(!1),r()}catch(d){console.error("Error deleting companies:",d)}};return e.jsxs(e.Fragment,{children:[s.length>0&&e.jsx(Q,{className:" flex items-center justify-between py-4 bg-white dark:bg-gray-800",stickyClass:"-mx-4 sm:-mx-8 border-t border-gray-200 dark:border-gray-700 px-8",defaultClass:"container mx-auto px-8 rounded-xl border border-gray-200 dark:border-gray-600 mt-4",children:e.jsx("div",{className:"container mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:s.length>0&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg text-primary",children:e.jsx(W,{})}),e.jsxs("span",{className:"font-semibold flex items-center gap-1",children:[e.jsxs("span",{className:"heading-text",children:[s.length," ","Schedules"]}),e.jsx("span",{children:"selected"})]})]})}),e.jsx("div",{className:"flex items-center",children:e.jsx(C,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error",onClick:c,children:"Delete"})})]})})}),e.jsx(U,{isOpen:o,type:"danger",title:"Remove schedules",onClose:i,onRequestClose:i,onCancel:i,onConfirm:u,children:e.jsxs("p",{children:[" ","Are you sure you want to remove these schedules? This action can't be undo."," "]})})]})},qe=()=>e.jsxs(e.Fragment,{children:[e.jsx(I,{children:e.jsx(_,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx("h3",{children:"Schedules"}),e.jsx(Z,{})]}),e.jsx(te,{}),e.jsx(Y,{})]})})}),e.jsx(se,{})]});export{qe as default};
