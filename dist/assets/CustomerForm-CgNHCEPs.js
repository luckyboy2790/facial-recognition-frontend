import{a as h,j as e,u as ne,T as te,i as re,R as ie}from"./index-D0yRYkRK.js";import{C as m,u as oe,F as me}from"./index.esm-0Wd5ZTaL.js";import"./FormContainer-CcnkfPvj.js";import{B as J,k as de}from"./Button-BDkok-2I.js";import{B as ce}from"./BottomStickyBar-B9Gkuokk.js";import{C as U}from"./Card-CWfRWYfe.js";import{I as w}from"./Input-CGGIPAMy.js";import{S as O,O as ue,c as ge}from"./Select-B-WXjZfd.js";import{A as q}from"./index-BAiP7mQm.js";import{F as d}from"./FormItem-BzCUTsvV.js";import{N as F}from"./NumericInput-Buu8NxfF.js";import{c as pe}from"./countries.constant-D1gzs3ev.js";import{D as he,F as fe,a as _}from"./FileItem-BgKRNRi7.js";import{f as ve}from"./employeeService-8m6wHAGi.js";import"./index-2Mnet4ey.js";import"./Dialog-B-jFmH1-.js";import"./Drawer-CnBtluTf.js";import"./index-92mjx-Fn.js";import"./index-DUpuQ3pa.js";import"./index-4hbIhcSA.js";import{c as xe}from"./cloneDeep-6-NADjKH.js";import"./index-B0EMbVo3.js";import"./index-CI41wOCL.js";import{t as be,N as je}from"./toast-CHrgrvAn.js";import"./context-CCEg-Yz5.js";import"./debounce-D_S4yuNl.js";import"./index-DLKOtp8K.js";import{c as k}from"./classNames-CVFWYafE.js";import{C as Ce}from"./CloseButton-V3ZvNBNU.js";import"./isNil-BZddQIJL.js";import{n as R,d as ye}from"./FaceMatcher-CdmDyCLL.js";import{z as i,t as Ne}from"./index-DMQ2Y9Ia.js";const{Control:De}=ge,Y=[{value:"MALE",label:"MALE"},{value:"FEMALE",label:"FEMALE"}],$=[{value:"SINGLE",label:"SINGLE"},{value:"MARRIED",label:"MARRIED"},{value:"ANNULLED",label:"ANNULLED"},{value:"WINDOWED",label:"WINDOWED"},{value:"LEGALLY SEPARATED",label:"LEGALLY SEPARATED"}],Se=s=>e.jsx(ue,{...s,customLabel:a=>e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(q,{shape:"circle",size:20,src:`/img/countries/${a.value}.png`}),e.jsx("span",{children:a.dialCode})]})}),Be=({children:s,...a})=>{const g=a.getValue()[0];return e.jsxs(De,{...a,children:[g&&e.jsx(q,{className:"ltr:ml-4 rtl:mr-4",shape:"circle",size:20,src:`/img/countries/${g.value}.png`}),s]})},Ee=({control:s,errors:a})=>{var v,o,x,y,B,N,D,S,E,p,c,b,j;const g=h.useMemo(()=>JSON.parse(JSON.stringify(pe)).map(r=>(r.label=r.dialCode,r)),[]);return e.jsxs(U,{children:[e.jsx("h4",{className:"mb-6",children:"Personal Information"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(d,{label:"First Name",invalid:!!a.firstName,errorMessage:(v=a.firstName)==null?void 0:v.message,children:e.jsx(m,{name:"firstName",control:s,render:({field:l})=>e.jsx(w,{type:"text",autoComplete:"off",placeholder:"First Name",value:l.value,onChange:l.onChange,onBlur:l.onBlur})})}),e.jsx(d,{label:"Last Name",invalid:!!a.lastName,errorMessage:(o=a.lastName)==null?void 0:o.message,children:e.jsx(m,{name:"lastName",control:s,render:({field:l})=>e.jsx(w,{type:"text",autoComplete:"off",placeholder:"Last Name",value:l.value,onChange:l.onChange,onBlur:l.onBlur})})})]}),e.jsx(d,{label:"Gender",invalid:!!a.gender,errorMessage:(x=a.gender)==null?void 0:x.message,children:e.jsx(m,{name:"gender",control:s,render:({field:l})=>e.jsx(O,{className:"mb-4",placeholder:"Please Select",options:Y,value:Y.find(r=>r.value===l.value),onChange:r=>l.onChange(r==null?void 0:r.value)})})}),e.jsx(d,{label:"Civil Status",invalid:!!a.civilStatus,errorMessage:(y=a.civilStatus)==null?void 0:y.message,children:e.jsx(m,{name:"civilStatus",control:s,render:({field:l})=>e.jsx(O,{className:"mb-4",placeholder:"Please Select",options:$,value:$.find(r=>r.value===l.value),onChange:r=>l.onChange(r==null?void 0:r.value)})})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(d,{label:"Height",invalid:!!a.height,errorMessage:(B=a.height)==null?void 0:B.message,children:e.jsx(m,{name:"height",control:s,render:({field:l})=>e.jsx(F,{autoComplete:"off",placeholder:"Height",value:l.value,onChange:l.onChange,onBlur:l.onBlur})})}),e.jsx(d,{label:"Weight",invalid:!!a.weight,errorMessage:(N=a.weight)==null?void 0:N.message,children:e.jsx(m,{name:"weight",control:s,render:({field:l})=>e.jsx(F,{autoComplete:"off",placeholder:"Weight",value:l.value,onChange:l.onChange,onBlur:l.onBlur})})})]}),e.jsx(d,{label:"Email",invalid:!!a.email,errorMessage:(D=a.email)==null?void 0:D.message,children:e.jsx(m,{name:"email",control:s,render:({field:l})=>e.jsx(w,{type:"email",autoComplete:"off",placeholder:"Email",value:l.value,onChange:l.onChange,onBlur:l.onBlur})})}),e.jsxs("div",{className:"flex items-end gap-4 w-full",children:[e.jsxs(d,{invalid:!!a.phoneNumber||!!a.dialCode,children:[e.jsx("label",{className:"form-label mb-2",children:"Phone number"}),e.jsx(m,{name:"dialCode",control:s,render:({field:l})=>e.jsx(O,{options:g,...l,className:"w-[150px]",components:{Option:Se,Control:Be},placeholder:"",value:g.filter(r=>r.dialCode===l.value),onChange:r=>l.onChange(r==null?void 0:r.dialCode)})})]}),e.jsx(d,{className:"w-full",invalid:!!a.phoneNumber||!!a.dialCode,errorMessage:(S=a.phoneNumber)==null?void 0:S.message,children:e.jsx(m,{name:"phoneNumber",control:s,render:({field:l})=>e.jsx(F,{autoComplete:"off",placeholder:"Phone Number",value:l.value,onChange:l.onChange,onBlur:l.onBlur})})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(d,{label:"Age",invalid:!!a.age,errorMessage:(E=a.age)==null?void 0:E.message,children:e.jsx(m,{name:"age",control:s,render:({field:l})=>e.jsx(F,{autoComplete:"off",placeholder:"Age",value:l.value,onChange:l.onChange,onBlur:l.onBlur})})}),e.jsx(d,{label:"Birthday",invalid:!!a.birthday,errorMessage:(p=a.birthday)==null?void 0:p.message,children:e.jsx(m,{name:"birthday",control:s,render:({field:l})=>e.jsx(he,{placeholder:"Birthday",value:l.value?new Date(l.value):null,onChange:r=>{l.onChange(r?r.toISOString().split("T")[0]:"")}})})})]}),e.jsx(d,{label:"National Id",invalid:!!a.nationalId,errorMessage:(c=a.nationalId)==null?void 0:c.message,children:e.jsx(m,{name:"nationalId",control:s,render:({field:l})=>e.jsx(w,{type:"text",autoComplete:"off",placeholder:"City, Province, Country",...l})})}),e.jsx(d,{label:"Place of birthday",invalid:!!a.placeOfBirth,errorMessage:(b=a.placeOfBirth)==null?void 0:b.message,children:e.jsx(m,{name:"placeOfBirth",control:s,render:({field:l})=>e.jsx(w,{type:"text",autoComplete:"off",placeholder:"House/Unit Number, Building, Street, City, Province, Country",...l})})}),e.jsx(d,{label:"Address",invalid:!!a.address,errorMessage:(j=a.address)==null?void 0:j.message,children:e.jsx(m,{name:"address",control:s,render:({field:l})=>e.jsx(w,{type:"text",autoComplete:"off",placeholder:"Address",...l})})})]})},z=s=>Object.keys(s).map(a=>s[a]),Me=s=>{const{accept:a,beforeUpload:g,disabled:v=!1,draggable:o=!1,fileList:x=[],fileListClass:y,fileItemClass:B,multiple:N,onChange:D,onFileRemove:S,ref:E,showList:p=!0,tip:c,uploadLimit:b,children:j,className:l,...r}=s,I=h.useRef(null),[M,A]=h.useState(x),[T,t]=h.useState(!1);h.useEffect(()=>{JSON.stringify(M)!==JSON.stringify(x)&&A(x)},[JSON.stringify(x)]);const n=(f="")=>{be.push(e.jsx(je,{type:"danger",duration:2e3,children:f||"Upload Failed!"}),{placement:"top-center"})},C=(f,u)=>{if(f)for(const L of f)u.push(L);return u},W=f=>{let u=xe(M);return typeof b=="number"&&b!==0&&Object.keys(u).length>=b?(b===1&&(u.shift(),u=C(f,u)),z({...u})):(u=C(f,u),z({...u}))},H=f=>{const{files:u}=f.target;let L=!0;if(g){if(L=g(u,M),L===!1){n();return}if(typeof L=="string"&&L.length>0){n(L);return}}if(L){const P=W(u);A(P),D==null||D(P,M)}},V=f=>{const u=M.filter((L,P)=>P!==f);A(u),S==null||S(u)},K=f=>{var u;v||(u=I.current)==null||u.click(),f.stopPropagation()},Q=()=>!o&&!j?e.jsx(J,{disabled:v,onClick:f=>f.preventDefault(),children:"Upload"}):o&&!j?e.jsx("span",{children:"Choose a file or drag and drop here"}):j,X=h.useCallback(()=>{o&&t(!1)},[o]),Z=h.useCallback(()=>{o&&!v&&t(!0)},[o,v]),ee=h.useCallback(()=>{o&&t(!1)},[o]),ae={onDragLeave:X,onDragOver:Z,onDrop:ee},G="border-primary",se=k("upload",o&&"upload-draggable",o&&!v&&`hover:${G}`,o&&v&&"disabled",T&&G,l),le=k("upload-input",o&&"draggable");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:E,className:se,...o?ae:{onClick:K},...r,children:[e.jsx("input",{ref:I,className:le,type:"file",disabled:v,multiple:N,accept:a,title:"",value:"",onChange:H,...r}),Q()]}),c,p&&e.jsx("div",{className:k("upload-file-list",y),children:M.map((f,u)=>e.jsx(fe,{file:f,className:B,children:e.jsx(Ce,{className:"upload-file-remove",onClick:()=>V(u)})},f.name+u))})]})},{MODE_DARK:Le}=te,Oe=({src:s,darkModeSrc:a,alt:g="",...v})=>{const o=ne(x=>x.mode);return e.jsx("img",{src:o===Le?a:s,alt:g,...v})},Ie=({control:s,errors:a})=>{var p,c,b,j,l,r,I,M,A,T;const[g,v]=h.useState([]),[o,x]=h.useState([]),[y,B]=h.useState([]),[N,D]=h.useState([]);h.useEffect(()=>{console.log(s)},[s]),h.useEffect(()=>{(async()=>{try{const n=await ve();v(n.company.map(C=>({label:C.company_name,value:C._id}))),x(n.department.map(C=>({label:C.department_name,value:C._id}))),B(n.jobTitle.map(C=>({label:C.job_title,value:C._id}))),D(n.leaveGroup.map(C=>({label:C.group_name,value:C._id})))}catch(n){console.error("Error fetching data:",n)}})()},[]);const S=[{label:"Regular",value:"Regular"},{label:"Trainee",value:"Trainee"}],E=[{label:"Active",value:"Active"},{label:"Archived",value:"Archived"}];return e.jsxs(e.Fragment,{children:[e.jsxs(U,{children:[e.jsx("h4",{className:"mb-6",children:"Employee Details(Designation)"}),e.jsx(d,{label:"Company",invalid:!!a.company,errorMessage:(p=a.company)==null?void 0:p.message,children:e.jsx(m,{name:"company",control:s,render:({field:t})=>e.jsx(O,{className:"mb-4",placeholder:"Please Select",options:g,value:g.find(n=>n.value===t.value),onChange:n=>t.onChange(n==null?void 0:n.value)})})}),e.jsx(d,{label:"Department",invalid:!!a.department,errorMessage:(c=a.department)==null?void 0:c.message,children:e.jsx(m,{name:"department",control:s,render:({field:t})=>e.jsx(O,{className:"mb-4",placeholder:"Please Select",options:o,value:o.find(n=>n.value===t.value),onChange:n=>t.onChange(n==null?void 0:n.value)})})}),e.jsx(d,{label:"Job Title",invalid:!!a.jobTitle,errorMessage:(b=a.jobTitle)==null?void 0:b.message,children:e.jsx(m,{name:"jobTitle",control:s,render:({field:t})=>e.jsx(O,{className:"mb-4",placeholder:"Please Select",options:y,value:y.find(n=>n.value===t.value),onChange:n=>t.onChange(n==null?void 0:n.value)})})}),e.jsx(d,{label:"PIN password",invalid:!!a.pin,errorMessage:(j=a.pin)==null?void 0:j.message,children:e.jsx(m,{name:"pin",control:s,render:({field:t})=>e.jsx(F,{autoComplete:"off",placeholder:"PIN (Between 6~10 numeric digits)",...t})})}),e.jsx(d,{label:"Email Address (Company)",invalid:!!a.companyEmail,errorMessage:(l=a.companyEmail)==null?void 0:l.message,children:e.jsx(m,{name:"companyEmail",control:s,render:({field:t})=>e.jsx(w,{type:"text",autoComplete:"off",placeholder:"email",...t})})}),e.jsx(d,{label:"Leave Group",invalid:!!a.leaveGroup,errorMessage:(r=a.leaveGroup)==null?void 0:r.message,children:e.jsx(m,{name:"leaveGroup",control:s,render:({field:t})=>e.jsx(O,{className:"mb-4",placeholder:"Please Select",options:N,value:N.find(n=>n.value===t.value),onChange:n=>t.onChange(n==null?void 0:n.value)})})})]}),e.jsxs(U,{children:[e.jsx("h4",{className:"mb-6",children:"Employee Details(Designation)"}),e.jsx(d,{label:"Employment Type",invalid:!!a.employmentType,errorMessage:(I=a.employmentType)==null?void 0:I.message,children:e.jsx(m,{name:"employmentType",control:s,render:({field:t})=>e.jsx(O,{className:"mb-4",placeholder:"Please Select",options:S,value:S.find(n=>n.value===t.value),onChange:n=>t.onChange(n==null?void 0:n.value)})})}),e.jsx(d,{label:"Employment Status",invalid:!!a.employmentStatus,errorMessage:(M=a.employmentStatus)==null?void 0:M.message,children:e.jsx(m,{name:"employmentStatus",control:s,render:({field:t})=>e.jsx(O,{className:"mb-4",placeholder:"Please Select",options:E,value:E.find(n=>n.value===t.value),onChange:n=>t.onChange(n==null?void 0:n.value)})})}),e.jsx(d,{label:"Official Start Date",invalid:!!a.officialStartDate,errorMessage:(A=a.officialStartDate)==null?void 0:A.message,children:e.jsx(m,{name:"officialStartDate",control:s,render:({field:t})=>e.jsx(_,{placeholder:"DATE",value:t.value?new Date(t.value):null,onChange:n=>{t.onChange(n?n.toISOString().split("T")[0]:"")}})})}),e.jsx(d,{label:"Date Regularized",invalid:!!a.dateRegularized,errorMessage:(T=a.dateRegularized)==null?void 0:T.message,children:e.jsx(m,{name:"dateRegularized",control:s,render:({field:t})=>e.jsx(_,{placeholder:"DATE",value:t.value?new Date(t.value):null,onChange:n=>{t.onChange(n?n.toISOString().split("T")[0]:"")}})})})]})]})},we="http://localhost:5000",Ae=({control:s,setValue:a,newCustomer:g,errors:v})=>{const[o,x]=h.useState(null),[y,B]=h.useState(!1),[N,D]=h.useState(!1);h.useEffect(()=>{if(!g&&s._formValues.faceDescriptor){const p=s._formValues.faceDescriptor.map(c=>Number(c));x(p),a("faceDescriptor",p),a("img",s._formValues.img)}},[g,s._formValues.faceDescriptor]),h.useEffect(()=>{(async()=>{try{const c="/models";await R.ssdMobilenetv1.loadFromUri(c),await R.faceLandmark68Net.loadFromUri(c),await R.faceRecognitionNet.loadFromUri(c),B(!0),console.log("Face-api models loaded successfully")}catch(c){console.error("Error loading face-api models:",c)}})()},[]);const S=p=>{let c=!0;const b=["image/jpeg","image/png"];if(p)for(const j of p)b.includes(j.type)||(c="Please upload a .jpeg or .png file!");return c},E=async(p,c)=>{if(!y){console.log("Models are still loading, please wait...");return}const b=URL.createObjectURL(p);c(b),D(!0);const j=new Image;j.src=b,j.onload=async()=>{try{const l=await ye(j).withFaceLandmarks().withFaceDescriptor();if(l){console.log("Face Descriptor:",l.descriptor);const r=Array.from(l.descriptor).map(I=>Number(I));a("faceDescriptor",r),x(r)}else console.log("No face detected"),a("faceDescriptor",[])}catch(l){console.error("Error detecting face:",l)}}};return e.jsxs(U,{children:[e.jsx("h4",{className:"mb-6",children:"Image"}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-lg text-center p-4",children:e.jsx("div",{className:"text-center",children:e.jsx(m,{name:"img",control:s,render:({field:p})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-center",children:p.value?e.jsx(q,{size:100,className:"border-4 border-white bg-gray-100 text-gray-300 shadow-lg",icon:e.jsx(de,{}),src:p.value?N?p.value:`${we}${p.value}`:""}):e.jsx(Oe,{src:"/img/others/upload.png",darkModeSrc:"/img/others/upload-dark.png",alt:"Upload image"})}),e.jsx(Me,{showList:!1,uploadLimit:1,beforeUpload:S,onChange:c=>{c.length>0&&E(c[0],p.onChange)},children:e.jsx(J,{variant:"solid",className:"mt-4",type:"button",disabled:!y,onClick:()=>D(!0),children:y?"Upload Image":"Loading Models..."})}),o&&g&&e.jsx("p",{className:"mt-2 text-sm text-green-600",children:"Image uploaded successfully."})]})})})})]})},Fe=i.object({firstName:i.string().min(1,{message:"First name required"}),lastName:i.string().min(1,{message:"Last name required"}),gender:i.string().min(1,{message:"Gender required"}),civilStatus:i.string().min(1,{message:"Civil Status required"}),email:i.string().min(1,{message:"Email required"}).email({message:"Invalid email"}),dialCode:i.string().min(1,{message:"Please select your country code"}),phoneNumber:i.string().min(1,{message:"Please input your mobile number"}),address:i.string().min(1,{message:"Addrress required"}),img:i.string().min(1,{message:"Civil Status required"}),height:i.string().regex(/^\d+$/,{message:"Height must be a numeric value"}).refine(s=>Number(s)>=50&&Number(s)<=250,{message:"Height must be between 50 cm and 250 cm"}),weight:i.string().regex(/^\d+$/,{message:"Weight must be a numeric value"}).refine(s=>Number(s)>=20&&Number(s)<=300,{message:"Weight must be between 20 kg and 300 kg"}),age:i.string().regex(/^\d+$/,{message:"Age must be a numeric value"}).refine(s=>Number(s)>=1&&Number(s)<=120,{message:"Age must be between 1 and 120"}),birthday:i.string().min(1,{message:"Birthday is required"}).regex(/^\d{4}-\d{2}-\d{2}$/,{message:"Invalid date format (YYYY-MM-DD)"}).refine(s=>new Date(s)<=new Date,{message:"Birthday cannot be in the future"}),nationalId:i.string().min(1,{message:"National Id required"}),placeOfBirth:i.string().min(1,{message:"Place of birth required"}),department:i.string().min(1,{message:"Department name required"}),company:i.string().min(1,{message:"Company name required"}),jobTitle:i.string().min(1,{message:"Job Title required"}),pin:i.string().regex(/^\d{6,10}$/,{message:"PIN must be between 6 and 10 numeric digits"}).refine(s=>Number(s)>=0&&Number(s)<=9999999999,{message:"PIN must be a 4-digit number between 1000 and 9999"}),companyEmail:i.string().min(1,{message:"Email required"}).email({message:"Invalid email"}),leaveGroup:i.string().min(1,{message:"Leave Group required"}),employmentType:i.string().min(1,{message:"Employment Type required"}),employmentStatus:i.string().min(1,{message:"Employment Status required"}),officialStartDate:i.string().min(1,{message:"Official Start Date is required"}).regex(/^\d{4}-\d{2}-\d{2}$/,{message:"Invalid date format (YYYY-MM-DD)"}),dateRegularized:i.string().min(1,{message:"Date Regularized is required"}).regex(/^\d{4}-\d{2}-\d{2}$/,{message:"Invalid date format (YYYY-MM-DD)"}),faceDescriptor:i.array(i.number(),{message:"Face descriptor must be an array of numbers"}).nonempty({message:"Face descriptor is required"}).refine(s=>s.length===128,{message:"Face descriptor must have exactly 128 values"})}),ga=s=>{const{onFormSubmit:a,defaultValues:g={},children:v,newCustomer:o}=s,{handleSubmit:x,reset:y,formState:{errors:B},control:N,setValue:D}=oe({defaultValues:{...g},resolver:Ne(Fe)});h.useEffect(()=>{re(g)||y(g)},[JSON.stringify(g)]);const S=E=>{a==null||a(E)};return e.jsxs(me,{className:"flex w-full h-full",containerClassName:"flex flex-col w-full justify-between",onSubmit:x(S),children:[e.jsx(ie,{children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsxs("div",{className:"gap-4 flex flex-col flex-auto",children:[e.jsx(Ae,{control:N,errors:B,setValue:D,newCustomer:o}),e.jsx(Ee,{control:N,errors:B}),e.jsx(Ie,{control:N,errors:B})]})})}),e.jsx(ce,{children:v})]})};export{ga as C};
