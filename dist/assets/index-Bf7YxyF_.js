import{V as L,W as j,a as v,j as e,b as E,R as I}from"./index-D0yRYkRK.js";import{A as R}from"./AdaptiveCard-C-V2GotN.js";import{A as z,T as y}from"./index-BAiP7mQm.js";import{T as P}from"./Tag-BiKNl5cb.js";import{D as K}from"./DataTable-H1C01gQK.js";import{b as F,c as $,d as B}from"./employeeService-8m6wHAGi.js";import{u as O}from"./index-x4T1Tg8z.js";import{c as u}from"./cloneDeep-6-NADjKH.js";import{c as V,d as q,e as G,f as W,g as M,h as Q}from"./index-BF8ULv3O.js";import{B as D}from"./Button-BDkok-2I.js";import{D as U}from"./DebouceInput-BQU4gTK3.js";import{S as H}from"./StickyFooter-CcqeJsEO.js";import{C as J}from"./ConfirmDialog-DLSh7DuB.js";import"./Card-CWfRWYfe.js";import"./useMergeRef-Ch7lRZ9Z.js";import"./floating-ui.dom-CV1Qg3mg.js";import"./index-BsIi-NiL.js";import"./proxy-CceN8Kfo.js";import"./classNames-CVFWYafE.js";import"./index-B0EMbVo3.js";import"./index-CLuxvRnD.js";import"./Select-B-WXjZfd.js";import"./extends-DynerIcZ.js";import"./index-2Mnet4ey.js";import"./isSymbol-DKaeyIQo.js";import"./toString-Db7_635E.js";import"./index-BerKXuJv.js";import"./useControllableState-DfqdUqDh.js";import"./_getPrototype-CX1IXfHZ.js";import"./Input-CGGIPAMy.js";import"./isNil-BZddQIJL.js";import"./useDebounce-D4jIpCY2.js";import"./debounce-D_S4yuNl.js";import"./Dialog-B-jFmH1-.js";import"./index-C6AgsrmA.js";import"./index-Chjiymov.js";import"./CloseButton-V3ZvNBNU.js";const X={pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},Y={tableData:X,selectedCustomer:[]},Z=L(s=>({...Y,setTableData:a=>s(()=>({tableData:a})),setSelectedCustomer:(a,l)=>s(o=>{const n=o.selectedCustomer;return a?{selectedCustomer:[...n,l]}:n.some(i=>l._id===i._id)?{selectedCustomer:n.filter(i=>i._id!==l._id)}:{selectedCustomer:n}}),setSelectAllCustomer:a=>s(()=>({selectedCustomer:a}))}));function b(){const{tableData:s,setTableData:a,selectedCustomer:l,setSelectedCustomer:o,setSelectAllCustomer:n}=Z(p=>p),{data:i,error:c,isLoading:x,mutate:d}=O(["/api/employee",{...s}],([p,f])=>F(f),{revalidateOnFocus:!1}),m=async p=>{await $({employeeIds:p}),d(),n([])},h=(i==null?void 0:i.list)||[],g=(i==null?void 0:i.total)||0;return{customerList:h,customerListTotal:g,error:c,isLoading:x,tableData:s,mutate:d,setTableData:a,selectedCustomer:l,deleteEmployees:m,setSelectedCustomer:o,setSelectAllCustomer:n}}const ee="http://localhost:5000",te={Active:"bg-emerald-200 dark:bg-emerald-200 text-gray-900 dark:text-gray-900",Archive:"bg-red-200 dark:bg-red-200 text-gray-900 dark:text-gray-900"},se=({row:s})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{size:40,shape:"circle",src:`${ee}${s.img}`}),e.jsx(E,{className:"hover:text-primary ml-2 rtl:mr-2 font-semibold text-gray-900 dark:text-gray-100",to:`/employee-details/${s._id}`,children:s.full_name})]}),re=({onEdit:s,onViewDetail:a,detail:l,handleArchiveEmployee:o})=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{title:"View",children:e.jsx("div",{className:"text-xl cursor-pointer select-none font-semibold",role:"button",onClick:a,children:e.jsx(V,{})})}),e.jsx(y,{title:"Edit",children:e.jsx("div",{className:"text-xl cursor-pointer select-none font-semibold",role:"button",onClick:s,children:e.jsx(q,{})})}),e.jsx(y,{title:"Archive",children:e.jsx("div",{className:"text-xl cursor-pointer select-none font-semibold",role:"button",onClick:o,children:e.jsx(G,{})})})]}),oe=()=>{const s=j(),{customerList:a,customerListTotal:l,tableData:o,isLoading:n,setTableData:i,setSelectAllCustomer:c,setSelectedCustomer:x,selectedCustomer:d,mutate:m}=b(),h=t=>{s(`/employee-edit/${t._id}`)},g=t=>{s(`/employee-details/${t._id}`)},p=async t=>{try{console.log(t),(await B({employeeId:t})).employee&&m()}catch(r){console.error("Error archiving employee:",r)}},f=v.useMemo(()=>[{header:"Name",accessorKey:"full_name",cell:t=>{const r=t.row.original;return e.jsx(se,{row:r})}},{header:"Company",accessorKey:"company.company_name"},{header:"Department",accessorKey:"department.department_name"},{header:"Position",accessorKey:"job_title.job_title"},{header:"Leave Privileges",accessorKey:"leave_group.group_name"},{header:"Status",accessorKey:"status",cell:t=>{const r=t.row.original;return e.jsx("div",{className:"flex items-center",children:e.jsx(P,{className:te[r.employee_status],children:e.jsx("span",{className:"capitalize",children:r.employee_status})})})}},{header:"",id:"action",cell:t=>e.jsx(re,{onEdit:()=>h(t.row.original),onViewDetail:()=>g(t.row.original),detail:t.row.original,handleArchiveEmployee:()=>p(t.row.original._id)})}],[]),C=t=>{i(t),d.length>0&&c([])},N=t=>{const r=u(o);r.pageIndex=t,C(r)},w=t=>{const r=u(o);r.pageSize=Number(t),r.pageIndex=1,C(r)},T=t=>{const r=u(o);r.sort=t,C(r)},S=(t,r)=>{x(t,r)},k=(t,r)=>{if(t){const _=r.map(A=>A.original);c(_)}else c([])};return e.jsx(K,{selectable:!0,columns:f,data:a,noData:!n&&a.length===0,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:n,pagingData:{total:l,pageIndex:o.pageIndex,pageSize:o.pageSize},checkboxChecked:t=>d.some(r=>r._id===t._id),onPaginationChange:N,onSelectChange:w,onSort:T,onCheckBoxChange:S,onIndeterminateCheckBoxChange:k})},ae=()=>{const s=j();return e.jsx("div",{className:"flex flex-col md:flex-row gap-3",children:e.jsx(D,{variant:"solid",icon:e.jsx(W,{className:"text-xl"}),onClick:()=>s("/employee-create"),children:"Add new"})})},ne=s=>{const{onInputChange:a,ref:l}=s;return e.jsx(U,{ref:l,placeholder:"Quick search...",suffix:e.jsx(M,{className:"text-lg"}),onChange:o=>a(o.target.value)})},le=()=>{const{tableData:s,setTableData:a}=b(),l=o=>{const n=u(s);n.query=o,n.pageIndex=1,typeof o=="string"&&o.length>1&&a(n),typeof o=="string"&&o.length===0&&a(n)};return e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:e.jsx(ne,{onInputChange:l})})},ie=()=>{const{selectedCustomer:s,mutate:a,deleteEmployees:l}=b(),[o,n]=v.useState(!1),i=()=>{n(!0)},c=()=>{n(!1)},x=async()=>{const d=s.map(m=>m._id).filter(m=>m!==void 0);if(d.length===0){console.error("No valid employee IDs to delete");return}try{await l(d),n(!1),a()}catch(m){console.error("Error deleting companies:",m)}};return e.jsxs(e.Fragment,{children:[s.length>0&&e.jsx(H,{className:" flex items-center justify-between py-4 bg-white dark:bg-gray-800",stickyClass:"-mx-4 sm:-mx-8 border-t border-gray-200 dark:border-gray-700 px-8",defaultClass:"container mx-auto px-8 rounded-xl border border-gray-200 dark:border-gray-600 mt-4",children:e.jsx("div",{className:"container mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:s.length>0&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg text-primary",children:e.jsx(Q,{})}),e.jsxs("span",{className:"font-semibold flex items-center gap-1",children:[e.jsxs("span",{className:"heading-text",children:[s.length," ","Customers"]}),e.jsx("span",{children:"selected"})]})]})}),e.jsx("div",{className:"flex items-center",children:e.jsx(D,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error",onClick:i,children:"Delete"})})]})})}),e.jsx(J,{isOpen:o,type:"danger",title:"Remove customers",onClose:c,onRequestClose:c,onCancel:c,onConfirm:x,children:e.jsxs("p",{children:[" ","Are you sure you want to remove these customers? This action can't be undo."," "]})})]})},Me=()=>e.jsxs(e.Fragment,{children:[e.jsx(I,{children:e.jsx(R,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx("h3",{children:"Employees"}),e.jsx(ae,{})]}),e.jsx(le,{}),e.jsx(oe,{})]})})}),e.jsx(ie,{})]});export{Me as default};
