import{Y as T,a as x,X as A,j as t,R as D}from"./index-D0yRYkRK.js";import{B as l}from"./Button-BDkok-2I.js";import{t as p,N as d}from"./toast-CHrgrvAn.js";import{C as k}from"./ConfirmDialog-DLSh7DuB.js";import{A as F}from"./AttendanceForm-BRu3qU08.js";import{s as j}from"./sleep-BvINh1mj.js";import{N as _}from"./NoUserFound-CrXboe5I.js";import{j as O,i as I}from"./index-BF8ULv3O.js";import{u as B}from"./index-x4T1Tg8z.js";import{c as R,b as E}from"./AttendanceService-BTxDC8aW.js";import"./classNames-CVFWYafE.js";import"./StatusIcon-BDOIg_yW.js";import"./CloseButton-V3ZvNBNU.js";import"./proxy-CceN8Kfo.js";import"./index-BAiP7mQm.js";import"./useMergeRef-Ch7lRZ9Z.js";import"./floating-ui.dom-CV1Qg3mg.js";import"./index-BsIi-NiL.js";import"./Dialog-B-jFmH1-.js";import"./index-C6AgsrmA.js";import"./index-Chjiymov.js";import"./index.esm-0Wd5ZTaL.js";import"./FormContainer-CcnkfPvj.js";import"./BottomStickyBar-B9Gkuokk.js";import"./Card-CWfRWYfe.js";import"./FormItem-BzCUTsvV.js";import"./FileItem-BgKRNRi7.js";import"./useControllableState-DfqdUqDh.js";import"./DatePickerRange-DFku8Lpw.js";import"./Input-CGGIPAMy.js";import"./isNil-BZddQIJL.js";import"./index-92mjx-Fn.js";import"./toString-Db7_635E.js";import"./isSymbol-DKaeyIQo.js";import"./index-BrAlWePZ.js";import"./employeeService-8m6wHAGi.js";import"./index-2Mnet4ey.js";import"./cloneDeep-6-NADjKH.js";import"./_getPrototype-CX1IXfHZ.js";import"./Drawer-CnBtluTf.js";import"./index-DUpuQ3pa.js";import"./index-4hbIhcSA.js";import"./Select-B-WXjZfd.js";import"./extends-DynerIcZ.js";import"./index-B0EMbVo3.js";import"./index-CLuxvRnD.js";import"./index-CI41wOCL.js";import"./format-BzRktsyD.js";const $="http://localhost:5000",Ot=()=>{const{id:n}=T(),{data:r,isLoading:u}=B([`/api/attendances${n}`,{id:n}],([e,o])=>R(o),{revalidateOnFocus:!1,revalidateIfStale:!1}),a=e=>{if(!e)return"";const o=new Date(e);if(isNaN(o.getTime()))throw new Error("Invalid date format");return o.toISOString().split("T")[1]},[g,m]=x.useState(!1),[w,h]=x.useState(!1),{token:f}=A(),b=async e=>{if(console.log("Submitted values",e),e.reason===""){p.push(t.jsx(d,{type:"warning",children:"Please write reason"}),{placement:"top-center"});return}h(!0);const o=await fetch(`${$}/api/attendance/update_attendance/${n}`,{method:"POST",headers:{"Content-Type":"application/json",...f?{Authorization:`Bearer ${f}`}:{}},body:JSON.stringify(e)}),i=await o.json(),s=o.ok?"success":"warning";h(!1),p.push(t.jsx(d,{type:s,children:i.message}),{placement:"top-center"}),await j(1500),window.location.href="/attendance"},y=()=>{if(console.log(r),r){const{employee:e,date:o,time_in:i,time_out:s,reason:v}=r.attendance;return console.log({employee:e,date:o,time_in:a(i||""),time_out:a(s||"")}),{employee:e,date:o,time_in:a(i||""),time_out:a(s||""),reason:v}}return{}},C=async()=>{m(!0),await E({attendanceIds:[n]}),p.push(t.jsx(d,{type:"success",children:"Schedule deleted!"}),{placement:"top-center"}),await j(1e3),window.location.href="/attendance"},S=()=>{m(!0)},c=()=>{m(!1)},N=()=>{history.back()};return t.jsxs(t.Fragment,{children:[!u&&!r&&t.jsxs("div",{className:"h-full flex flex-col items-center justify-center",children:[t.jsx(_,{height:280,width:280}),t.jsx("h3",{className:"mt-8",children:"No user found!"})]}),!u&&r&&t.jsxs(t.Fragment,{children:[t.jsx(F,{defaultValues:y(),newAttendance:!1,onFormSubmit:b,children:t.jsx(D,{children:t.jsxs("div",{className:"flex items-center justify-between px-8",children:[t.jsx(l,{className:"ltr:mr-3 rtl:ml-3",type:"button",variant:"plain",icon:t.jsx(O,{}),onClick:N,children:"Back"}),t.jsxs("div",{className:"flex items-center",children:[t.jsx(l,{className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error bg-transparent",icon:t.jsx(I,{}),onClick:S,children:"Delete"}),t.jsx(l,{variant:"solid",type:"submit",loading:w,children:"Save"})]})]})})}),t.jsx(k,{isOpen:g,type:"danger",title:"Remove attendances",onClose:c,onRequestClose:c,onCancel:c,onConfirm:C,children:t.jsxs("p",{children:["Are you sure you want to remove this attendance? This action can't be undo."," "]})})]})]})};export{Ot as default};
