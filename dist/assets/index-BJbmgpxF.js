import{W as A,j as e,V as R,a as f,R as _}from"./index-D0yRYkRK.js";import{A as b}from"./AdaptiveCard-C-V2GotN.js";import{B as v}from"./Button-BDkok-2I.js";import"./isNil-BZddQIJL.js";import"./context-CCEg-Yz5.js";import"./index-BAiP7mQm.js";import"./Dialog-B-jFmH1-.js";import"./index-B0EMbVo3.js";import{c as j}from"./cloneDeep-6-NADjKH.js";import"./index-2Mnet4ey.js";import"./debounce-D_S4yuNl.js";import"./index-92mjx-Fn.js";import"./index-DLKOtp8K.js";import"./Drawer-CnBtluTf.js";import{v as F,C as z,h as M,g as O}from"./index-BF8ULv3O.js";import{r as N}from"./index-CLuxvRnD.js";import{C as V}from"./index-DasjbrLe.js";import{R as C}from"./FileItem-BgKRNRi7.js";import"./FormContainer-CcnkfPvj.js";import{I as L}from"./Input-CGGIPAMy.js";import"./index-DUpuQ3pa.js";import"./index-4hbIhcSA.js";import{t as D,N as S}from"./toast-CHrgrvAn.js";import"./index-CI41wOCL.js";import{a as B,b as E,c as P}from"./leaveTypeService-BeHiIq0T.js";import{u as w}from"./index-x4T1Tg8z.js";import{D as q}from"./DataTable-H1C01gQK.js";import{S as K}from"./StickyFooter-CcqeJsEO.js";import{C as Y}from"./ConfirmDialog-DLSh7DuB.js";import{D as W}from"./DebouceInput-BQU4gTK3.js";import"./Card-CWfRWYfe.js";import"./classNames-CVFWYafE.js";import"./index-Chjiymov.js";import"./useMergeRef-Ch7lRZ9Z.js";import"./floating-ui.dom-CV1Qg3mg.js";import"./index-BsIi-NiL.js";import"./proxy-CceN8Kfo.js";import"./index-C6AgsrmA.js";import"./CloseButton-V3ZvNBNU.js";import"./useControllableState-DfqdUqDh.js";import"./_getPrototype-CX1IXfHZ.js";import"./isSymbol-DKaeyIQo.js";import"./toString-Db7_635E.js";import"./index-BrAlWePZ.js";import"./DatePickerRange-DFku8Lpw.js";import"./StatusIcon-BDOIg_yW.js";import"./Select-B-WXjZfd.js";import"./extends-DynerIcZ.js";import"./index-BerKXuJv.js";import"./useDebounce-D4jIpCY2.js";const G=()=>{const t=A(),s=[];return e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx(V,{className:"w-full",filename:"customerList.csv",data:s,children:e.jsx(v,{icon:e.jsx(F,{className:"text-xl"}),className:"w-full",children:"Download"})}),e.jsx(v,{variant:"solid",icon:e.jsx(z,{className:"text-xl"}),children:"Import"}),e.jsx(v,{variant:"solid",icon:e.jsx(N,{className:"text-xl"}),onClick:()=>t("/leavegroup"),children:"Add leave group"})]})},Q={pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},U={tableData:Q,selectedLeaveType:[]},H=R(t=>({...U,setTableData:s=>t(()=>({tableData:s})),setSelectedLeaveType:(s,r)=>t(o=>{const a=o.selectedLeaveType;return s?{selectedLeaveType:[...a,r]}:a.some(n=>r._id===n._id)?{selectedLeaveType:a.filter(n=>n._id!==r._id)}:{selectedLeaveType:a}}),setSelectAllLeaveType:s=>t(()=>({selectedLeaveType:s}))}));function T(){const{tableData:t,setTableData:s,selectedLeaveType:r,setSelectedLeaveType:o,setSelectAllLeaveType:a}=H(l=>l),{data:n,error:m,isLoading:h,mutate:p}=w(["/api/leaveTypes",{...t}],([l,x])=>B(x),{revalidateOnFocus:!1}),d=async l=>{await E({leaveTypeIds:l}),p(),a([])},g=(n==null?void 0:n.list)||[],y=(n==null?void 0:n.total)||0;return{leaveTypeList:g,leaveTypeListTotal:y,error:m,isLoading:h,tableData:t,deleteLeaveTypes:d,mutate:p,setTableData:s,selectedLeaveType:r,setSelectedLeaveType:o,setSelectAllLeaveType:a}}const J=()=>{const[t,s]=f.useState("Monthly"),[r,o]=f.useState(""),[a,n]=f.useState(""),{mutate:m}=T(),h=l=>{s(l)},p=async()=>P({leaveName:r,credits:a,percalendar:t}),{data:d,isLoading:g}=w("/api/company/create",{revalidateOnFocus:!1}),y=async()=>{var l;try{if(r===""){D.push(e.jsx(S,{title:"error",type:"danger",children:"You have to fill company name."}));return}const x=Number(a);if(isNaN(x)||x<0||x>365){D.push(e.jsx(S,{title:"error",type:"danger",children:"Credits must be a number between 0 and 365."}));return}const u=await p();(l=u==null?void 0:u.company)!=null&&l._id&&(m(),o(""),n(""),s("Monthly")),console.log(u)}catch(x){console.error("Error creating company:",x)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(L,{placeholder:'Leave Name (e.g. "Vacation Leave, Sick Leave")',value:r,onChange:l=>o(l.target.value)}),e.jsx(L,{placeholder:'Credits (e.g. "15" (days))',value:a,onChange:l=>n(l.target.value)}),e.jsxs(C.Group,{vertical:!0,value:t,onChange:h,children:[e.jsx(C,{value:"Monthly",children:"Monthly"}),e.jsx(C,{value:"Yearly",children:"Yearly"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(v,{variant:"solid",icon:e.jsx(N,{}),onClick:y,loading:g,children:"Create"})})]})},X=()=>{const{leaveTypeList:t,leaveTypeListTotal:s,tableData:r,isLoading:o,setTableData:a,setSelectAllLeaveType:n,setSelectedLeaveType:m,selectedLeaveType:h}=T(),p=f.useMemo(()=>[{header:"Description",accessorKey:"leave_name"},{header:"Credits",accessorKey:"credits"},{header:"Term",accessorKey:"percalendar"}],[]),d=c=>{a(c),h.length>0&&n([])},g=c=>{const i=j(r);i.pageIndex=c,d(i)},y=c=>{const i=j(r);i.pageSize=Number(c),i.pageIndex=1,d(i)},l=c=>{const i=j(r);i.sort=c,d(i)},x=(c,i)=>{m(c,i)},u=(c,i)=>{if(c){const k=i.map(I=>I.original);n(k)}else n([])};return e.jsx(q,{selectable:!0,columns:p,data:t,noData:!o&&t.length===0,skeletonAvatarColumns:[0],skeletonAvatarProps:{width:28,height:28},loading:o,pagingData:{total:s,pageIndex:r.pageIndex,pageSize:r.pageSize},checkboxChecked:c=>h.some(i=>i._id===c._id),onPaginationChange:g,onSelectChange:y,onSort:l,onCheckBoxChange:x,onIndeterminateCheckBoxChange:u})},Z=()=>{const{selectedLeaveType:t,mutate:s,deleteLeaveTypes:r}=T(),[o,a]=f.useState(!1),n=()=>{a(!0)},m=()=>{a(!1)},h=async()=>{const p=t.map(d=>d._id).filter(d=>d!==void 0);if(p.length===0){console.error("No valid company IDs to delete");return}try{await r(p),a(!1),s()}catch(d){console.error("Error deleting companies:",d)}};return e.jsxs(e.Fragment,{children:[t.length>0&&e.jsx(K,{className:" flex items-center justify-between py-4 bg-white dark:bg-gray-800",stickyClass:"-mx-4 sm:-mx-8 border-t border-gray-200 dark:border-gray-700 px-8",defaultClass:"container mx-auto px-8 rounded-xl border border-gray-200 dark:border-gray-600 mt-4",children:e.jsx("div",{className:"container mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:t.length>0&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg text-primary",children:e.jsx(M,{})}),e.jsxs("span",{className:"font-semibold flex items-center gap-1",children:[e.jsxs("span",{className:"heading-text",children:[t.length," ","LeaveTypes"]}),e.jsx("span",{children:"selected"})]})]})}),e.jsx("div",{className:"flex items-center",children:e.jsx(v,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error",onClick:n,children:"Delete"})})]})})}),e.jsx(Y,{isOpen:o,type:"danger",title:"Remove customers",onClose:m,onRequestClose:m,onCancel:m,onConfirm:h,children:e.jsxs("p",{children:[" ","Are you sure you want to remove these companies? This action can't be undo."," "]})})]})},$=t=>{const{onInputChange:s,ref:r}=t;return e.jsx(W,{ref:r,placeholder:"Quick search...",suffix:e.jsx(O,{className:"text-lg"}),onChange:o=>s(o.target.value)})},ee=()=>{const{tableData:t,setTableData:s}=T(),r=o=>{const a=j(t);a.query=o,a.pageIndex=1,typeof o=="string"&&o.length>1&&s(a),typeof o=="string"&&o.length===0&&s(a)};return e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:e.jsx($,{onInputChange:r})})},Xe=()=>e.jsxs(e.Fragment,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsx("h3",{children:"Add Leave Types"}),e.jsx(G,{})]}),e.jsx(b,{children:e.jsx(J,{})}),e.jsxs(b,{children:[e.jsx(ee,{}),e.jsx(X,{})]})]})}),e.jsx(Z,{})]});export{Xe as default};
