import{W as D,a as l,j as e,R as N,X as T}from"./index-D0yRYkRK.js";import{B as d}from"./Button-BDkok-2I.js";import{t as u,N as h}from"./toast-CHrgrvAn.js";import{C as E}from"./CustomerForm-CgNHCEPs.js";import{C as F}from"./ConfirmDialog-DLSh7DuB.js";import{i as O}from"./index-BF8ULv3O.js";import"./classNames-CVFWYafE.js";import"./StatusIcon-BDOIg_yW.js";import"./CloseButton-V3ZvNBNU.js";import"./proxy-CceN8Kfo.js";import"./index.esm-0Wd5ZTaL.js";import"./FormContainer-CcnkfPvj.js";import"./BottomStickyBar-B9Gkuokk.js";import"./Card-CWfRWYfe.js";import"./Input-CGGIPAMy.js";import"./isNil-BZddQIJL.js";import"./Select-B-WXjZfd.js";import"./extends-DynerIcZ.js";import"./floating-ui.dom-CV1Qg3mg.js";import"./index-BAiP7mQm.js";import"./useMergeRef-Ch7lRZ9Z.js";import"./index-BsIi-NiL.js";import"./FormItem-BzCUTsvV.js";import"./NumericInput-Buu8NxfF.js";import"./countries.constant-D1gzs3ev.js";import"./FileItem-BgKRNRi7.js";import"./useControllableState-DfqdUqDh.js";import"./DatePickerRange-DFku8Lpw.js";import"./index-92mjx-Fn.js";import"./toString-Db7_635E.js";import"./isSymbol-DKaeyIQo.js";import"./index-BrAlWePZ.js";import"./employeeService-8m6wHAGi.js";import"./index-2Mnet4ey.js";import"./cloneDeep-6-NADjKH.js";import"./_getPrototype-CX1IXfHZ.js";import"./Dialog-B-jFmH1-.js";import"./index-C6AgsrmA.js";import"./index-Chjiymov.js";import"./Drawer-CnBtluTf.js";import"./index-DUpuQ3pa.js";import"./index-4hbIhcSA.js";import"./index-B0EMbVo3.js";import"./index-CLuxvRnD.js";import"./index-CI41wOCL.js";import"./context-CCEg-Yz5.js";import"./debounce-D_S4yuNl.js";import"./index-DLKOtp8K.js";import"./FaceMatcher-CdmDyCLL.js";import"./index-DMQ2Y9Ia.js";const f="http://localhost:5000",Fe=()=>{const g=D(),[y,i]=l.useState(!1),[b,s]=l.useState(!1),x=async t=>{console.log("Submitted values",t),s(!0);const{token:o}=T();try{let r=t.img;if(t.img&&t.img.startsWith("blob:")){const c=new FormData,S=await(await fetch(t.img)).blob();c.append("image",S,"profile.jpg");const m=await(await fetch(`${f}/api/upload-image`,{method:"POST",body:c,headers:{...o?{Authorization:`Bearer ${o}`}:{}}})).json();if(!m.success){console.error("❌ Failed to upload image:",m.message),s(!1);return}r=m.imageUrl}const n={...t,img:r,faceDescriptor:t.faceDescriptor};console.log(n);const p=await fetch(`${f}/api/employee/create_employee`,{method:"POST",headers:{"Content-Type":"application/json",...o?{Authorization:`Bearer ${o}`}:{}},body:JSON.stringify(n)}),w=await p.json();if(!p.ok)throw new Error(w.message||"Failed to create employee");u.push(e.jsx(h,{type:"success",children:"Employee created successfully!"}),{placement:"top-center"}),window.location.href="/employees"}catch(r){console.error("❌ Error submitting form:",r)}s(!1)},C=()=>{i(!0),u.push(e.jsx(h,{type:"success",children:"Customer discardd!"}),{placement:"top-center"}),g("/employees")},j=()=>{i(!0)},a=()=>{i(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(E,{newCustomer:!0,defaultValues:{firstName:"",lastName:"",email:"",gender:"",img:"",phoneNumber:"",dialCode:"",address:"",civilStatus:"",height:"",weight:"",age:"",birthday:"",nationalId:"",placeOfBirth:"",company:"",department:"",jobTitle:"",pin:"",companyEmail:"",leaveGroup:"",employmentType:"",employmentStatus:"",officialStartDate:"",dateRegularized:"",faceDescriptor:[]},onFormSubmit:x,children:e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between px-8",children:[e.jsx("span",{}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(d,{className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error bg-transparent",icon:e.jsx(O,{}),onClick:j,children:"Discard"}),e.jsx(d,{variant:"solid",type:"submit",loading:b,children:"Create"})]})]})})}),e.jsx(F,{isOpen:y,type:"danger",title:"Discard changes",onClose:a,onRequestClose:a,onCancel:a,onConfirm:C,children:e.jsxs("p",{children:["Are you sure you want discard this? This action can't be undo."," "]})})]})};export{Fe as default};
